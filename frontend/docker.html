<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker | Akara的前端笔记</title>
    <meta name="generator" content="VuePress 1.7.0">
    <link rel="icon" href="/blog/favicon.ico">
    <meta name="description" content="Fooly Cooly">
    
    <link rel="preload" href="/blog/assets/css/0.styles.e57ea1a4.css" as="style"><link rel="preload" href="/blog/assets/js/app.8456fffd.js" as="script"><link rel="preload" href="/blog/assets/js/2.8618d6ad.js" as="script"><link rel="preload" href="/blog/assets/js/23.9f56128f.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.3ff23fab.js"><link rel="prefetch" href="/blog/assets/js/11.09b35f14.js"><link rel="prefetch" href="/blog/assets/js/12.a5230948.js"><link rel="prefetch" href="/blog/assets/js/13.da084bb4.js"><link rel="prefetch" href="/blog/assets/js/14.73ecbf39.js"><link rel="prefetch" href="/blog/assets/js/15.094f6105.js"><link rel="prefetch" href="/blog/assets/js/16.d882b772.js"><link rel="prefetch" href="/blog/assets/js/17.f99a3402.js"><link rel="prefetch" href="/blog/assets/js/18.efb4f04e.js"><link rel="prefetch" href="/blog/assets/js/19.07110711.js"><link rel="prefetch" href="/blog/assets/js/20.328904f9.js"><link rel="prefetch" href="/blog/assets/js/21.8cbdc7e9.js"><link rel="prefetch" href="/blog/assets/js/22.d2057d2a.js"><link rel="prefetch" href="/blog/assets/js/24.b6b30cbb.js"><link rel="prefetch" href="/blog/assets/js/25.54438b61.js"><link rel="prefetch" href="/blog/assets/js/26.37498cf1.js"><link rel="prefetch" href="/blog/assets/js/27.2b58fbd4.js"><link rel="prefetch" href="/blog/assets/js/28.6c08951d.js"><link rel="prefetch" href="/blog/assets/js/29.e0f75c79.js"><link rel="prefetch" href="/blog/assets/js/3.b9f752a5.js"><link rel="prefetch" href="/blog/assets/js/30.ab15011f.js"><link rel="prefetch" href="/blog/assets/js/31.8cf1b6d0.js"><link rel="prefetch" href="/blog/assets/js/32.73cca382.js"><link rel="prefetch" href="/blog/assets/js/33.2a56a474.js"><link rel="prefetch" href="/blog/assets/js/34.42cb3d03.js"><link rel="prefetch" href="/blog/assets/js/35.94137746.js"><link rel="prefetch" href="/blog/assets/js/36.e851453a.js"><link rel="prefetch" href="/blog/assets/js/37.dfcaa02b.js"><link rel="prefetch" href="/blog/assets/js/38.773d62c5.js"><link rel="prefetch" href="/blog/assets/js/39.fff934a2.js"><link rel="prefetch" href="/blog/assets/js/4.5a189e09.js"><link rel="prefetch" href="/blog/assets/js/40.d1f5a698.js"><link rel="prefetch" href="/blog/assets/js/41.de3b1ae8.js"><link rel="prefetch" href="/blog/assets/js/42.3ad3f220.js"><link rel="prefetch" href="/blog/assets/js/43.4b9dc29e.js"><link rel="prefetch" href="/blog/assets/js/44.bb8ac6d0.js"><link rel="prefetch" href="/blog/assets/js/45.3de7dbda.js"><link rel="prefetch" href="/blog/assets/js/46.6e6c0e4f.js"><link rel="prefetch" href="/blog/assets/js/47.1c9bfac2.js"><link rel="prefetch" href="/blog/assets/js/48.484b889d.js"><link rel="prefetch" href="/blog/assets/js/49.b9d5c97f.js"><link rel="prefetch" href="/blog/assets/js/5.f2578a9e.js"><link rel="prefetch" href="/blog/assets/js/50.805af6ea.js"><link rel="prefetch" href="/blog/assets/js/51.e4b8b0bf.js"><link rel="prefetch" href="/blog/assets/js/52.88f0f15b.js"><link rel="prefetch" href="/blog/assets/js/53.dc5a22fc.js"><link rel="prefetch" href="/blog/assets/js/54.589407ad.js"><link rel="prefetch" href="/blog/assets/js/55.534c1c0e.js"><link rel="prefetch" href="/blog/assets/js/56.7e25d242.js"><link rel="prefetch" href="/blog/assets/js/57.4c00257c.js"><link rel="prefetch" href="/blog/assets/js/58.2846c49a.js"><link rel="prefetch" href="/blog/assets/js/59.5cdc41e2.js"><link rel="prefetch" href="/blog/assets/js/6.b035c77d.js"><link rel="prefetch" href="/blog/assets/js/60.69050108.js"><link rel="prefetch" href="/blog/assets/js/7.e580f382.js"><link rel="prefetch" href="/blog/assets/js/8.db5c9552.js"><link rel="prefetch" href="/blog/assets/js/9.d0e88da4.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.e57ea1a4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Akara的前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/frontend/" class="nav-link router-link-active">
  前端博客
</a></div><div class="nav-item"><a href="/blog/mianshi/" class="nav-link">
  面经
</a></div><div class="nav-item"><a href="/blog/gossip/" class="nav-link">
  杂记
</a></div> <a href="https://github.com/messiahhh/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/blog/frontend/" class="nav-link router-link-active">
  前端博客
</a></div><div class="nav-item"><a href="/blog/mianshi/" class="nav-link">
  面经
</a></div><div class="nav-item"><a href="/blog/gossip/" class="nav-link">
  杂记
</a></div> <a href="https://github.com/messiahhh/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/blog/frontend/" aria-current="page" class="sidebar-link">HTML</a></li><li><a href="/blog/frontend/css.html" class="sidebar-link">CSS</a></li><li><a href="/blog/frontend/javascript.html" class="sidebar-link">JavaScript</a></li><li><a href="/blog/frontend/node.html" class="sidebar-link">Node</a></li><li><a href="/blog/frontend/stream.html" class="sidebar-link">流与二进制</a></li><li><a href="/blog/frontend/react.html" class="sidebar-link">React</a></li><li><a href="/blog/frontend/react相关库.html" class="sidebar-link">React相关库</a></li><li><a href="/blog/frontend/vue.html" class="sidebar-link">Vue</a></li><li><a href="/blog/frontend/react-vs-vue.html" class="sidebar-link">React-vs-Vue</a></li><li><a href="/blog/frontend/typescript.html" class="sidebar-link">TypeScript</a></li><li><a href="/blog/frontend/typescript-in-react.html" class="sidebar-link">TypeScript-In-React</a></li><li><a href="/blog/frontend/browser.html" class="sidebar-link">浏览器相关</a></li><li><a href="/blog/frontend/前端工程化.html" class="sidebar-link">前端工程化</a></li><li><a href="/blog/frontend/计算机网络.html" class="sidebar-link">计算机网络</a></li><li><a href="/blog/frontend/前端安全.html" class="sidebar-link">前端安全</a></li><li><a href="/blog/frontend/错误监控.html" class="sidebar-link">错误监控</a></li><li><a href="/blog/frontend/网站优化.html" class="sidebar-link">性能优化</a></li><li><a href="/blog/frontend/数据结构.html" class="sidebar-link">数据结构</a></li><li><a href="/blog/frontend/排序.html" class="sidebar-link">排序算法</a></li><li><a href="/blog/frontend/编程题.html" class="sidebar-link">编程题</a></li><li><a href="/blog/frontend/mongodb.html" class="sidebar-link">MongoDB</a></li><li><a href="/blog/frontend/mysql.html" class="sidebar-link">Mysql</a></li><li><a href="/blog/frontend/linux.html" class="sidebar-link">Linux</a></li><li><a href="/blog/frontend/git.html" class="sidebar-link">Git</a></li><li><a href="/blog/frontend/docker.html" aria-current="page" class="active sidebar-link">Docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/frontend/docker.html#docker" class="sidebar-link">Docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/frontend/docker.html#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/docker.html#wsl" class="sidebar-link" style="padding-left:3rem;">WSL</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/docker.html#基础" class="sidebar-link">基础</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/docker.html#image" class="sidebar-link" style="padding-left:3rem;">image</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/docker.html#container" class="sidebar-link" style="padding-left:3rem;">container</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/docker.html#打包镜像" class="sidebar-link">打包镜像</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/docker.html#dockerfile" class="sidebar-link" style="padding-left:3rem;">Dockerfile</a></li></ul></li></ul></li><li><a href="/blog/frontend/设计模式.html" class="sidebar-link">设计模式</a></li><li><a href="/blog/frontend/websocket.html" class="sidebar-link">WebSocket</a></li><li><a href="/blog/frontend/webgl.html" class="sidebar-link">Three.js</a></li><li><a href="/blog/frontend/php.html" class="sidebar-link">PHP</a></li><li><a href="/blog/frontend/代码段记录.html" class="sidebar-link">代码记录</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h2> <h3 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h3> <h4 id="wsl"><a href="#wsl" class="header-anchor">#</a> WSL</h4> <p><code>windows</code>系统下安装Docker需要几个前置条件，首先<code>windows</code>版本需要大于<code>v1903</code>，并且我们需要启用<code>Window Subsystem Linux(WSL2)</code>，可以根据微软的<a href="https://docs.microsoft.com/zh-cn/windows/wsl/install-win10" target="_blank" rel="noopener noreferrer">官方指南<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>进行环境的安装。</p> <p>安装好<code>WSL</code>后我们可以在终端通过输入<code>wsl</code>来切换成对应的Linux发行版。</p> <p>搭建好基础环境之后我们就可以直接安装<code>Docker desktop</code>软件，安装好<code>Docker</code>后我们就可以在终端使用<code>Docker</code>命令，或者是借助<code>Docker desktop</code>桌面应用来直接执行各种操作，本博客重点介绍命令行下的操作。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker version <span class="token comment"># 验证安装成功</span>
</code></pre></div><blockquote><p>最好修改一下镜像源来加速镜像的获取</p></blockquote> <h3 id="基础"><a href="#基础" class="header-anchor">#</a> 基础</h3> <p>使用<code>Docker</code>时，我们通常会使用他人的镜像<code>image</code>或自己打包的<code>image</code>在容器<code>container</code>中运行。</p> <h4 id="image"><a href="#image" class="header-anchor">#</a> image</h4> <blockquote><p>部分命令可以省略image一词</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>docker image <span class="token function">ls</span> <span class="token comment"># 本地所有镜像</span>
docker image <span class="token function">rm</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span> <span class="token comment"># 删除镜像</span>
docker image pull akara/my-image <span class="token comment"># akara/my-image为组名/镜像名</span>
docker image pull hello-world <span class="token comment"># 如果不指定组名，则默认拉取library组内的镜像（官方镜像）</span>
</code></pre></div><h4 id="container"><a href="#container" class="header-anchor">#</a> container</h4> <blockquote><p>部分命令可以省略container一词</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>docker container <span class="token function">ls</span> <span class="token comment"># 查看正在运行中的容器。或者 docker ps</span>
docker container <span class="token function">ls</span> --all <span class="token comment"># 查看所有的容器，包括没有运行的容器。或者 docker ps -a</span>
</code></pre></div><p>当我们本地存在镜像<code>image</code>，就可以运行在容器中了。通常情况运行完成后，容器会<strong>自动退出运行</strong>状态。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker container run hello-world <span class="token comment"># 运行容器，如果本地不存在该镜像，则会自动拉取远程镜像</span>
</code></pre></div><p>我们可以在运行容器的时候加上<code>-it</code>标识，实现<strong>通过终端访问容器内部</strong>，在退出终端后容器会<strong>退出运行</strong>。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker container run -it hello-world /bin/bash <span class="token comment"># 选择/bin/bash作为shell</span>
</code></pre></div><p>我们可以通过<code>-d</code>搭配<code>-it</code>使用，<code>-d</code>的作用是让容器在后台运行，从而实现类似守护进程的效果。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker run -p <span class="token number">8000</span>:3000 -itd  koa-demo  /bin/bash
</code></pre></div><p>当容器在后台运行时，我们可以使用<code>docker attach</code>或<code>docker exec</code>来进入容器，通常推荐使用<code>docker exec</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker <span class="token builtin class-name">exec</span> -it <span class="token operator">&lt;</span>containerID<span class="token operator">&gt;</span> /bin/bash
</code></pre></div><hr> <p>很多时候我们的容器内部都跑着HTTP服务器，通常是无法被外部直接访问的，为此我们需要实现主机和容器之间的<strong>端口映射</strong>。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker container run -p <span class="token number">8000</span>:3000 -it hello-world /bin/bash
</code></pre></div><p>像这里我们使用<code>-p 8000:3000</code>实现了端口映射，可以通过本机的8000端口访问目标容器的3000端口。除了<code>-p</code>我们还可以使用<code>-P</code>来实现随机端口映射。</p> <hr> <p>我们也可以手动退出容器。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker container stop <span class="token operator">&lt;</span>containerID<span class="token operator">&gt;</span> <span class="token comment"># 优雅的退出</span>
docker container <span class="token function">kill</span> <span class="token operator">&lt;</span>containerID<span class="token operator">&gt;</span> <span class="token comment"># 粗暴的退出</span>

docker container start <span class="token operator">&lt;</span>containerID<span class="token operator">&gt;</span> <span class="token comment"># 启动容器</span>
</code></pre></div><p>无论是容器自动运行结束，还是我们手动退出容器，容器本身还是占据着硬盘空间，我们可以使用<code>rm</code>命令彻底删除容器</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker container <span class="token function">rm</span> <span class="token operator">&lt;</span>containerID<span class="token operator">&gt;</span>
</code></pre></div><h3 id="打包镜像"><a href="#打包镜像" class="header-anchor">#</a> 打包镜像</h3> <p>通过编写<code>Dockerfile</code>我们可以实现将本地项目打包成<code>Docker</code>镜像<code>image</code>，从而提供给他人运行在容器<code>container</code>当中。</p> <p>通常使用<code>.dockerignore</code>文件指出哪些文件不要被打包进镜像当中。</p> <div class="language-markdown extra-class"><pre class="language-markdown"><code>.git
node_modules
</code></pre></div><h4 id="dockerfile"><a href="#dockerfile" class="header-anchor">#</a> Dockerfile</h4> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token comment"># Dockerfile</span>
<span class="token keyword">FROM</span> node<span class="token punctuation">:</span>8.4 <span class="token comment"># 新镜像基于node镜像</span>
<span class="token keyword">COPY</span> . /app <span class="token comment"># 将当前目录文件都复制进镜像的/app文件夹下</span>
<span class="token keyword">WORKDIR</span> /app <span class="token comment"># 指定工作目录为/app</span>
<span class="token keyword">RUN</span> npm install <span class="token punctuation">-</span><span class="token punctuation">-</span>registry=https<span class="token punctuation">:</span>//registry.npm.taobao.org 
<span class="token keyword">EXPOSE</span> 3000 <span class="token comment"># 容器暴露的端口</span>
<span class="token keyword">CMD</span> node app.js <span class="token comment"># 容器启动后执行的操作</span>
</code></pre></div><blockquote><p>如果我们使用<code>docker run -it xxx /bin/bash</code>，则<code>CMD</code>命令不会执行。使用<code>docker run -it xxx</code>的话，会执行<code>CMD</code>的命令。</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>docker image build -t <span class="token operator">&lt;</span>image_name<span class="token operator">&gt;</span> <span class="token builtin class-name">.</span> <span class="token comment"># 构建镜像，通过-t指定镜像名</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/messiahhh/blog/edit/master/docs/frontend/docker.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">5/24/2021, 3:10:42 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/frontend/git.html" class="prev">
        Git
      </a></span> <span class="next"><a href="/blog/frontend/设计模式.html">
        设计模式
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.8456fffd.js" defer></script><script src="/blog/assets/js/2.8618d6ad.js" defer></script><script src="/blog/assets/js/23.9f56128f.js" defer></script>
  </body>
</html>
